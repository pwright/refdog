- name: site
  yaml_example: |
    version: 1
    site:
      name: east
      ingress: none
      router-cpu-limit: 2
  kubernetes_example: |
    apiVersion: skupper.io/v1alpha1
    kind: Site
    metadata:
      name: east
      namespace: east
    spec:
      ingress: none
      routerCpuLimit: 2
  cli_example: |
    skupper init --site-name east --ingress none --router-cpu-limit 2
  groups:
    - name: site
      entries:
        - name: name
          default:
          type: string
          description: |
            A name of your choice for the Skupper site.
        - name: annotations
          default:
          type: strings
          description: |
            Annotations to add to Skupper pods.
        - name: labels
          default:
          type: strings
          description: |
            Labels to add to skupper pods
        - name: create-network-policy
          default: n
          type: boolean
          description: |
            Create network policy to restrict access to Skupper services
            exposed through this site to the pods currently in the
            namespace.
        - name: enable-rest-api
          default:
          type: boolean
          description: |
            Enable REST API
    - name: ingress
      entries:
        - name: ingress
          default: route if available, else loadbalancer
          type: string
          choices: [route, loadbalancer, nodeport, nginx-ingress-v1, contour-http-proxy, ingress, none]
          description: |
            Setup Skupper ingress to one of
        - name: ingress-host
          default: null
          type: string
          description: |
            The hostname or alias by which the ingress route or proxy can
            be reached.
        - name: ingress-annotations
          default:
          type: strings
          description: |
            Annotations to add to skupper ingress
    - name: console
      entries:
        - name: console-enabled
          default: n
          type: boolean
          description: |
            Enable skupper console must be used in conjunction with
            '--enable-flow-collector' flag
        - name: console-auth
          default: internal
          type: string
          choices: [internal, openshift, unsecured]
          description: |
            The user authentication method for the console.
        - name: console-user
          default: admin
          type: string
          description: |
            The console username when using internal authentication.
        - name: console-password
          default: "[generated]"
          type: string
          description: |
            The console password when using internal authentication.
        - name: console-ingress
          default:
          type: string
          choices: [route, loadbalancer, nodeport, nginx-ingress-v1, contour-http-proxy, ingress, none]
          description: |
            Determines if/how console is exposed outside cluster. If
            not specified uses value of --ingress.
    - name: service-sync
      entries:
        - name: service-sync-enabled
          default: y
          type: boolean
          description: |
            Participate in cross-site service synchronization
        - name: service-sync-site-ttl
          default:
          type: duration
          description: |
            Time after which stale services, i.e. those whose site has not been heard from, created through service-sync are removed.
    - name: config-sync
      entries:
        - name: config-sync-cpu
          default:
          type: string
          description: |
            CPU request for config-sync pods
        - name: config-sync-memory
          default:
          type: string
          description: |
            Memory request for config-sync pods
        - name: config-sync-cpu-limit
          default:
          type: string
          description: |
            CPU limit for config-sync pods
        - name: config-sync-memory-limit
          default:
          type: string
          description: |
            Memory limit for config-sync pods
    - name: controller
      entries:
        - name: controller-cpu
          default:
          type: string
          description: |
            CPU request for controller pods
        - name: controller-memory
          default:
          type: string
          description: |
            Memory request for controller pods
        - name: controller-cpu-limit
          default:
          type: string
          description: |
            CPU limit for controller pods
        - name: controller-memory-limit
          default:
          type: string
          description: |
            Memory limit for controller pods
        - name: controller-node-selector
          default:
          type: string
          description: |
            Node selector to control placement of controller pods
        - name: controller-pod-affinity
          default:
          type: string
          description: |
            Pod affinity label matches to control placement of controller pods
        - name: controller-pod-antiaffinity
          default:
          type: string
          description: |
            Pod antiaffinity label matches to control placement of controller pods
        - name: controller-ingress-host
          default:
          type: string
          description: |
            Host through which node is accessible when using nodeport as ingress.
        - name: controller-load-balancer-ip
          default:
          type: string
          description: |
            Load balancer ip that will be used for controller service, if supported by cloud provider
        - name: controller-service-annotation
          default:
          type: strings
          description: |
            Annotations to add to skupper controller service
    - name: flow-collector
      entries:
        - name: flow-collector-enabled
          default: n
          type: boolean
          description: |
            Enable cross-site flow collection for the application network
        - name: flow-collector-record-ttl
          default: 30m
          type: duration
          description: |
            Time after which terminated flow records are deleted,
            i.e. those flow records that have an end time set.
        - name: flow-collector-cpu
          default:
          type: string
          description: |
            CPU request for flow collector pods
        - name: flow-collector-memory
          default:
          type: string
          description: |
            Memory request for flow collector pods
        - name: flow-collector-cpu-limit
          default:
          type: string
          description: |
            CPU limit for flow collector pods
        - name: flow-collector-memory-limit
          default:
          type: string
          description: |
            Memory limit for flow collector pods
    - name: router
      entries:
        - name: router-mode
          default: interior
          type: string
          choices: [interior, edge]
          description: |
            The role of the router in the router topology.  Interior
            routers do XXX.  Edge routers only do YYY.
        - name: router-logging
          default: info
          type: string
          choices: [trace, debug, info, notice, warning, error]
          description: |
            Logging settings for router
        - name: router-debug-mode
          default:
          type: string
          choices: [asan, gdb]
          description: |
            Enable debug mode for the router
        - name: routers
          default:
          type: integer
          description: |
            Number of router replicas to start
        - name: router-cpu
          default:
          type: string
          description: |
            CPU request for router pods
        - name: router-memory
          default:
          type: string
          description: |
            Memory request for router pods
        - name: router-cpu-limit
          default:
          type: string
          description: |
            CPU limit for router pods
        - name: router-memory-limit
          default:
          type: string
          description: |
            Memory limit for router pods
        - name: router-node-selector
          default:
          type: string
          description: |
            Node selector to control placement of router pods
        - name: router-pod-affinity
          default:
          type: string
          description: |
            Pod affinity label matches to control placement of router pods
        - name: router-pod-antiaffinity
          default:
          type: string
          description: |
            Pod antiaffinity label matches to control placement of router pods
        - name: router-ingress-host
          default:
          type: string
          description: |
            Host through which node is accessible when using nodeport as ingress.
        - name: router-load-balancer-ip
          default:
          type: string
          description: |
            Load balancer ip that will be used for router service, if supported by cloud provider
        - name: router-service-annotations
          default:
          type: strings
          description: |
            Annotations to add to skupper router service
- name: link
  yaml_example: |
    version: 1
    site:
      name: east
      links:
        - name: link-to-west
          token-file: west-token-1.yaml
  kubernetes_example: |
    apiVersion: skupper.io/v1alpha1
    kind: Link
    metadata:
      name: link-to-west
      namespace: east
    spec:
      tokenSecret: west-token-1
  cli_example: |
    skupper -n east link create west-token-1.yaml --name link-to-west
  entries:
    - name: name
      default: "[Generated]"
      type: string
      description: |
        An optional name for the link (used when deleting it).
    - name: token-file
      type: string
      platform: podman
      description: |
        The path to the file that contains the token.
    - name: token-secret
      type: string
      platform: kubernetes
      description: |
        The path to the secret that contains the token.
    - name: cost
      default: 1
      type: integer
      description: |
        Specify a cost for this link.
- name: token
  yaml_example: |
    version: 1
    site:
      name: west
      token:
        token-file: west-token-1.yaml
        expiry: 1h
  kubernetes_example: |
    apiVersion: skupper.io/v1alpha1
    kind: Token
    metadata:
      name: west-token-1
      namespace: west
    spec:
      tokenSecret: west-token-1
      expiry: 1h
  cli_example: |
    skupper -n west token create west-token-1.yaml --expiry 1h
  entries:
    - name: token-file
      type: string
      platform: podman
      description: |
        The path to the file that is to contain the generated token
        data.
    - name: token-secret
      type: string
      platform: kubernetes
      description: |
        The name of the Kubernetes secret that is to contain the
        generated token data.
    - name: expiry
      default: 15m
      type: duration
      description: |
        Expiration time for claim (only valid if --token-type=claim).
    - name: uses
      default: 1
      type: integer
      description: |
        Number of uses for which claim will be valid (only valid if
        --token-type=claim).
    - name: name
      default: skupper (?)
      type: string
      description: |
        An optional name for the remote site that will use this token
        to create a link.
- name: provided-service
  yaml_example: |
    version: 1
    site:
      name: east
      provided-services:
        - name: backend
          ports:
            - port: 8080
              target-port: 9090
  kubernetes_example: |
    apiVersion: skupper.io/v1alpha1
    kind: ProvidedService
    metadata:
      name: backend
      namespace: east
    spec:
      ports:
        - port: 8080
          targetPort: 9090
  cli_example: |
    # Current
    skupper -n east service create backend 8080
    skupper -n east service bind backend deployment/backend --target-port 9090
    # Proposed
    skupper -n east service provide backend:8080 deployment/backend --target-port 9090
  entries:
    - name: target-port
      default:
      type: strings
      description: |
        The port the target is listening on (you can also use colon to map source-port to a target-port).
    - name: tls-trust
      default:
      type: string
      description: |
        The Kubernetes secret name with the CA to expose the service
        over TLS.
    - name: publish-not-ready-addresses
      default: n
      type: boolean
      description: |
        If specified, skupper will not wait for pods to be ready
- name: required-service
  yaml_example: |
    version: 1
    site:
      name: west
      required-services:
        - name: backend
          ports:
            - port: 8080
  kubernetes_example: |
    apiVersion: skupper.io/v1alpha1
    kind: RequiredService
    metadata:
      name: backend
      namespace: west
    spec:
      ports:
        - port: 8080
  cli_example: |
    # Current
    skupper -n west service create backend 8080
    # Proposed
    skupper -n west service require backend:8080
  entries:
    - name: protocol
      default: tcp
      type: string
      choices: [tcp, http, http2]
      description: |
        The protocol mapping in use for this service address.
    - name: generate-tls-secrets
      default: n
      type: boolean
      description: |
        If specified, the service communication will be encrypted using TLS
    - name: tls-cert
      default:
      type: string
      description: |
        The Kubernetes secret name with custom certificates to encrypt
        the communication using TLS.
    - name: ingress-enabled
      default: Always
      type: string
      choices: [Always, Never]
      description: |
        Determines whether access to the Skupper service is enabled in
        this site.

        XXX I want a note here that says that some future iteration
        might include a third state.
    - name: event-channel
      default: n
      type: boolean
      description: |
        If specified, this service will be a channel for multicast events.
    - name: aggregate
      default: "?"
      type: string
      choices: [json, multipart]
      description: |
        The aggregation strategy to use. One of 'json' or
        'multipart'. If specified requests to this service will be
        sent to all registered implementations and the responses
        aggregated.
    - name: bridge-image
      default:
      type: string
      description: |
        The image to use for a bridge running external to the skupper router
